# CodeWiki Web 前端

## 功能特性

### 调用图可视化

CodeWiki 提供了强大的函数调用关系可视化功能，支持三种不同的布局方式：

#### 🌳 树状布局（默认）
- **层次清晰**：按照调用关系自动分层，根节点在左侧，子节点向右扩展
- **结构直观**：清晰展示函数的调用层次和依赖关系
- **易于理解**：适合分析代码结构和调用流程
- **自动排列**：节点位置自动计算，无需手动调整

#### 🔗 Graphviz 风格布局
- **力导向布局**：使用物理模拟算法，节点自动分布
- **紧凑美观**：节点分布更加均匀，减少空白区域
- **动态效果**：布局切换时带有平滑的动画过渡
- **专业外观**：类似专业图形可视化工具的效果

#### 📊 Mermaid 图表布局
- **专业图表**：使用Mermaid语法生成标准化的流程图
- **美观清晰**：节点和连接线布局更加专业美观
- **易于分享**：支持导出为图片或SVG格式
- **标准兼容**：符合行业标准的图表展示方式

### 布局切换

- 点击布局按钮可以在三种布局之间循环切换：树状 → Graphviz → Mermaid → 树状
- 树状和Graphviz布局切换时会自动重新计算节点位置
- Mermaid布局使用专业图表引擎，提供最佳的可视化效果
- 支持实时预览和即时切换

### 交互功能

- **节点拖拽**：可以手动调整节点位置
- **缩放平移**：支持鼠标滚轮缩放和拖拽平移
- **展开折叠**：点击节点上的 +/- 按钮展开或折叠子节点
- **节点详情**：点击节点查看详细信息
- **文件跳转**：从调用图直接跳转到对应的源代码文件

### 使用说明

1. **查看调用图**：在代码查看器中点击函数名称
2. **切换布局**：点击调用图顶部的布局按钮，支持三种布局循环切换
3. **调整视图**：在树状和Graphviz布局中使用鼠标滚轮缩放，拖拽空白区域平移
4. **展开节点**：在树状和Graphviz布局中点击节点上的展开按钮查看更多调用关系
5. **查看详情**：点击节点查看函数和文件的详细信息
6. **Mermaid图表**：在Mermaid布局中享受专业美观的图表展示

### 技术实现

- 使用 React + TypeScript 构建
- SVG 渲染，支持高分辨率显示
- 自定义布局算法，支持树状和力导向布局
- Mermaid 图表引擎，提供专业图表展示
- 响应式设计，适配不同屏幕尺寸
- 性能优化，支持大量节点的流畅显示

## 开发说明

### 项目结构

```
web/
├── src/
│   ├── components/
│   │   ├── CallGraph.tsx      # 调用图组件
│   │   ├── RepoManager.tsx    # 仓库管理组件
│   │   ├── CodeViewer.tsx     # 代码查看器
│   │   └── NodeDetails.tsx    # 节点详情组件
│   ├── utils/
│   │   └── graphUtils.ts      # 图形布局工具
│   ├── types/
│   │   └── index.ts           # 类型定义
│   └── services/
│       └── api.ts             # API 服务
├── package.json
└── README.md
```

### 布局算法

#### 树状布局
- 使用拓扑排序确定节点层级
- 按层级从左到右排列
- 每层内节点垂直居中分布
- 固定间距，确保层次清晰

#### Graphviz 布局
- 基于力导向算法
- 节点间排斥力避免重叠
- 连接节点间吸引力保持关系
- 迭代优化，达到稳定状态

#### Mermaid 布局
- 使用Mermaid语法生成标准化流程图
- 自动优化节点和连接线布局
- 支持多种图表主题和样式
- 专业美观，适合文档和演示

### 自定义配置

可以通过修改以下参数调整布局效果：

```typescript
// 树状布局间距
const TREE_GAP_X = 200;  // 水平间距
const TREE_GAP_Y = 100;  // 垂直间距

// Graphviz 布局参数
const repulsionForce = 1000;  // 排斥力强度
const attractionForce = 0.1;  // 吸引力强度
const iterations = 50;         // 迭代次数
const damping = 0.8;          // 阻尼系数
```

## 浏览器支持

- Chrome 80+
- Firefox 75+
- Safari 13+
- Edge 80+

## 许可证

MIT License
